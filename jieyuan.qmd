---
title: "jieyuan_lab"
author: "jieyuan yan"
format: html
---

## This is my dplyr lab

### Preparing library
```{r}
#| message: false
here::i_am('grades-eval.Rproj')
library(here)
library(dplyr)
library(vroom)
library(ggplot2)
library(tidyr)
```

## Question1

Load the DataSet
```{r}
grades = vroom(here('grades.csv'),show_col_types = FALSE)
```

## Question2

The data set contains `{r} nrow(grades)` grades

```{r}
nrow(grades)
```

## Question3

The data set contains `{r} nrow(grades|>distinct(id))` students

```{r}
nrow(grades|>distinct(id))
```

## Question4

- create a dataframe named students.
- extract the last five rows of students.
```{r}
students = grades|>distinct(id,.keep_all = TRUE)|> select(id,group)
students |> slice_tail(n = 5) |> knitr::kable()
```

# Question5

- use group_by and summarise to get the number
- use ggplot and geom_bar to plot the bar chart
- use labs and theme_minimal to beautify
```{r}
students|>group_by(group)|>summarise(number=n())|>
  ggplot(aes(x=group,y=number))+geom_bar(stat = "identity")+
  labs(x = "Group", y = "Number of Students") +
  theme_minimal()
```

## Question6

- use filter to select the qualified data
- use groupby, summarise, mean to get the average grade
- use ggplot and geom_col to plot the data
```{r}
grades|>filter(course=='Astroengineering and Planetary Colonization')|>
  group_by(group)|>summarise(average_grade=mean(grade))|>
  ggplot(aes(x=group,y=average_grade))+geom_col(fill = "skyblue")
```

## Question7
- use boxplot
```{r}
grades|>ggplot(aes(x=semester,y = grade, group = semester)) +
  geom_boxplot()
```
- use desensity and facet_warp
```{r}
grades|>ggplot(aes(x=grade)) +
  geom_density()+facet_wrap(~semester)
```

```{r}
```


```{r}
```


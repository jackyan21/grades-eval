---
title: "jieyuan_lab"
author: "jieyuan yan"
format: html
---

## This is my dplyr lab

### Preparing library
```{r}
#| message: false
here::i_am('grades-eval.Rproj')
library(here)
library(dplyr)
library(vroom)
library(ggplot2)
library(tidyr)
```

## Question1

Load the DataSet
```{r}
grades = vroom(here('grades.csv'),show_col_types = FALSE)
```

## Question2

The data set contains `{r} nrow(grades)` grades

```{r}
nrow(grades)
```

## Question3

The data set contains `{r} nrow(grades|>distinct(id))` students

```{r}
nrow(grades|>distinct(id))
```

## Question4

- create a dataframe named students.
- extract the last five rows of students.
```{r}
students = grades|>distinct(id,.keep_all = TRUE)|> select(id,group)
students |> slice_tail(n = 5) |> knitr::kable()
```

# Question5

- use group_by and summarise to get the number
- use ggplot and geom_bar to plot the bar chart
- use labs and theme_minimal to beautify
```{r}
students|>group_by(group)|>summarise(number=n())|>
  ggplot(aes(x=group,y=number))+geom_bar(stat = "identity")+
  labs(x = "Group", y = "Number of Students") +
  theme_minimal()
```

## Question6

- use filter to select the qualified data
- use groupby, summarise, mean to get the average grade
- use ggplot and geom_col to plot the data
```{r}
grades|>filter(course=='Astroengineering and Planetary Colonization')|>
  group_by(group)|>summarise(average_grade=mean(grade))|>
  ggplot(aes(x=group,y=average_grade))+geom_col(fill = "skyblue")
```

## Question7
- use boxplot
```{r}
grades|>ggplot(aes(x=semester,y = grade, group = semester)) +
  geom_boxplot()
```
- use desensity and facet_warp
```{r}
grades|>ggplot(aes(x=grade)) +
  geom_density()+facet_wrap(~semester)
```

## Question8

- group_by the id and group.
- extract the first six rows.
```{r}
num_grades = grades|>group_by(id, group) |>
  summarize(num_grades = n(), .groups = "drop")
num_grades|>slice(1:6)
```
- summarise the data
```{r}
num_grades_stat = num_grades |> summarize(
    min_num = min(num_grades),
    max_num = max(num_grades),
    avg_num = mean(num_grades),
    median_num = median(num_grades)
  )
```

- display the table

| Statistic     | Value   |
|---------------|---------|
| Minimum       | `r num_grades_stat$min_num` |
| Maximum       | `r num_grades_stat$max_num` |
| Average       | `r num_grades_stat$avg_num` |
| Median        | `r num_grades_stat$median_num` |

## Question9

- group_by
```{r}
AI_info = grades|>filter(course=='Artificial Intelligence and Robotics')|>group_by(id, group) |>
  summarize(num_grades = n(), .groups = "drop")
AI_info|>slice(1:6)
```
## Question10

```{r}
AI_info|>group_by(num_grades)|>summarise(num_students=n())|>
  ggplot(aes(x=num_grades,y=num_students))+geom_col()
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

